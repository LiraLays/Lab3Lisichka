# Лабораторная работа №3: Верификация циклов с инвариантами

## О проекте

WPF приложение для демонстрации верификации циклов с использованием инвариантов и формальных требований. Проект позволяет визуализировать процесс выполнения циклов для различных операций над массивами с проверкой корректности через инварианты и weakest precondition.

**Основная цель**: Реализация системы пошагового выполнения циклов с визуализацией инвариантов, вариантов и формальных требований для операций суммирования, подсчета и поиска максимума.

## Архитектура проекта

### ClassLab3 - библиотека бизнес-логики
- `Class1.cs` - основной класс для работы с циклами и операциями над массивами
- `ClassFormalRequirements.cs` - класс для работы с формальными требованиями

### WpfLab3 - WPF приложение
- `MainWindow.xaml` - пользовательский интерфейс
- `MainWindow.xaml.cs` - логика взаимодействия с пользователем

## Функциональность

### Реализованные операции над массивами

#### Сумма элементов массива
- Вычисление суммы всех элементов
- Инвариант: `res = сумма первых i элементов`
- Визуализация пошагового вычисления

#### Подсчет элементов больше T
- Подсчет количества элементов, превышающих заданное значение T
- Инвариант: `res = количество элементов > T среди первых i`
- Проверка граничных условий

#### Поиск максимального элемента
- Нахождение наибольшего элемента в массиве
- Инвариант: `res = максимальный среди первых i элементов`
- Обработка специальных случаев

### Визуальные возможности

- **Пошаговое выполнение** - детальная трассировка каждой итерации цикла
- **Визуальные индикаторы** - цветовые индикаторы состояния цикла и инварианта
- **Прогресс-бар** - отображение прогресса выполнения через вариант-функцию
- **Формальные требования** - отображение предусловий, инвариантов и постусловий
- **Weakest precondition** - демонстрация формулы weakest precondition для циклов

## Технологии

- **.NET 8** - целевая платформа
- **WPF** - пользовательский интерфейс
- **MVVM** - архитектурный паттерн
- **INotifyPropertyChanged** - механизм уведомлений об изменениях
- **XAML** - разметка пользовательского интерфейса

## Принципы верификации циклов

### Инварианты циклов

**Сумма элементов**
```
Inv: res = Σ_{k=0}^{i-1} array[k]
```

**Подсчет элементов**
```
Inv: res = |{ k ∈ [0..i-1] : array[k] > T }|
```

**Максимальный элемент**
```
Inv: res = max(array[0..i-1])
```

### Weakest Precondition для циклов
```
(Inv ∧ B) ⇒ wp(S, Inv)
```

Если в начале итерации цикла выполняются и инвариант (Inv), и условие продолжения цикла (B), то после выполнения тела цикла (S) инвариант (Inv) должен сохраняться.

### Вариант-функция
```
t(i) = j - i
```

Где `i` - текущий индекс, `j` - длина массива. Функция гарантирует завершение цикла.

## Запуск проекта

### Предварительные требования

- .NET 8 SDK или выше
- Visual Studio 2022 или VS Code с C# расширениями

### Инструкция по запуску

1. **Клонирование репозитория**
```bash
git clone <repository-url>
cd WpfLab3
```

2. **Восстановление зависимостей**
```bash
dotnet restore
```

3. **Сборка проекта**
```bash
dotnet build
```

4. **Запуск приложения**
```bash
dotnet run
```

**Альтернативный запуск через Visual Studio**
- Откройте WpfLab3.sln
- Нажмите F5 для запуска

##Использование приложения

###Работа с массивами
1. **Генерация массива**
- Установите размер массива с помощью слайдера
- Нажмите "Сгенерировать массив" для создания случайного массива
2. **Выбор операции**
- Выберите тип операции: Сумма, Максимум или Количество > T
- Для операции подсчета введите значение T

###Режимы выполнения
**Пошаговый режим**
1. Нажмите "Шаг" для выполнения одной итерации цикла
2. Наблюдайте за изменением состояния в реальном времени
3. Анализируйте инварианты и вариант-функцию
**Автоматический режим**
1. Нажмите "Пуск" для мгновенного выполнения всей операции
2. Получите итоговый результат и состояние POST

###Просмотр формальных требований
1. Начните цикл в пошаговом режиме
2. Нажмите "Показать формальные требования"
3. Изучите предусловия, инварианты, постусловия и условия верификации

##Структура данных

###Класс Class1
Основной класс для работы с циклами и операциями над массивами
```csharp
public enum TaskType
{
    Sum,
    Count, 
    Max,
    None
}

public struct Cycle
{
    public bool post;
    public int i;
    public int res;
    public int[] array;
    public TaskType taskType;
    public int T;
}
```

**Основные методы:**
- GenerateNSizeArray() - генерация случайного массива
- InitializeCycle() - инициализация структуры цикла
- MakeOperation() - полное выполнение операции
- MakeStep() - выполнение одного шага цикла
- InvariantType() - получение текста и формулы инварианта

###Класс ClassFormalRequirements
Класс для работы с формальными требованиями верификации
```csharp
public class ClassFormalRequirements
{
    public static string[] ShowAllFormalRequirements(TaskType taskType, int i, int j)
    public static string ShowWpFormula()
}
```

**Основные методы:**
- ShowAllFormalRequirements() - возвращает полный набор формальных требований
- ShowWpFormula() - возвращает формулу weakest precondition

##Особенности реализации

###Надежность вычислений
- Проверка корректности входных данных
- Обработка граничных случаев (пустые массивы, крайние значения)
- Валидация пользовательского ввода
- Защита от исключений при парсинге

###Пользовательский интерфейс
- Интуитивный дизайн с цветовыми индикаторами
- Пошаговая визуализация процесса выполнения
- Подробные сообщения о состоянии вычислений
- Адаптивный интерфейс для разных сценариев использования

###Расширяемость
- Модульная архитектура с четким разделением ответственности
- Легкость добавления новых операций над массивами
- Гибкая система инвариантов и формальных требований
- Чистый код с хорошей тестируемостью

###Дальнейшее развитие
Возможные направления для улучшения проекта:
1. Новые операции - добавление операций поиска минимума, среднего значения, фильтрации
2. Расширенные инварианты - поддержка сложных инвариантов для вложенных циклов
3. Визуализация данных - графическое представление массива и процесса его обработки
4. Экспорт результатов - возможность сохранения результатов вычислений и формальных требований
5. Автоматическое тестирование - интеграция с системами автоматической верификации

###Разработчики
Полосков А.Д. Дубков С.В. Иванов М.А. Проект разработан в учебных целях для демонстрации принципов верификации циклов с использованием инвариантов и формальных методов.

###Лицензия
Проект создан для образовательных целей. Свободное использование и модификация разрешены.